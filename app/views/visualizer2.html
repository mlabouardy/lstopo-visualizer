<div ng-include="'views/filter.html'"></div>

<div class="row">
  	<div class="col-md-12">
	    <div class="panel panel-primary">
	      	<div class="panel-heading"><i class="fa fa-eye"></i> Visualizer</div>
		      	<div ng-style="{'font-size': font_size}" id="components" class="panel-body">
					<div class="entity" ng-if="alignementComponents('Groups')" ng-repeat="entity in ::entities" ng-include="'lstopoTree'">
					</div>
					<div class="entity" ng-if="!alignementComponents('Groups')" ng-repeat="entity in ::entities" ng-style="{'display' : 'table-cell'}" ng-include="'lstopoTree'">
					</div>

      				<script type="text/ng-template" id="lstopoTree">

				        <div ng-show="checkArrayEntity(entity,'Groups')" class="group" ng-if="entity.type=='Group'">
				            <div ng-style="{'background-color':userConfig.colors[8].color}" class="frame"><p>{{::entity.type}} {{::entity.depth}}</p>
				            	<span ng-repeat="entity in ::entity.children" ng-include="'lstopoTree'">
				            	</span>
				            </div>
				        </div>

				        <div ng-if="alignementComponents('Packages')">
							<div ng-show="checkArrayEntity(entity,'Packages')" class="frame package" ng-if="entity.type=='Package'" ng-style="{'background-color':userConfig.colors[7].color}">
								<p>{{::entity.type}} P#{{::entity.os_index}}</p>
								<span ng-repeat="entity in ::entity.children" ng-include="'lstopoTree'">
								</span>
							</div>
						</div>

						<div ng-if="!alignementComponents('Packages')">
							<div ng-show="checkArrayEntity(entity,'Packages')" class="frame package" ng-if="entity.type=='Package'" ng-style="{'background-color':userConfig.colors[7].color, 'display' : 'table-cell'}">
								<p>{{::entity.type}} P#{{::entity.os_index}}</p>
								<span ng-repeat="entity in ::entity.children" ng-include="'lstopoTree'">
								</span>
							</div>
						</div>

						<div ng-if="alignementComponents('NUMANodes')">
							<div ng-show="checkArrayEntity(entity,'NUMANodes')" class="numanode frame" ng-if="entity.type=='NUMANode'" ng-style="{'background-color':userConfig.colors[5].color}">
								<div class="frame" ng-style="{'background-color':userConfig.colors[6].color}"><p>{{::entity.type}} P#{{::entity.os_index}} ({{::convertMemory(entity.memory)}})</p></div>
								<span ng-repeat="entity in ::entity.children" ng-include="'lstopoTree'">
								</span>
								<span ng-if="entity.pciTree" ng-repeat="tree in ::entity.pciTree" ng-style="{'width': '20%'}">
									<canvas id="{{ ::'tree-' + $index + '-' + tree.os_index }}" ng-controller="TestCtrl" ng-init="begin(tree, $index)" height="500" width="600"></canvas>
								</span>
								</div>
							</div>
						</div>

						<div ng-if="!alignementComponents('NUMANodes')">
							<div ng-show="checkArrayEntity(entity,'NUMANodes')" class="numanode frame" ng-if="entity.type=='NUMANode'" ng-style="{'background-color':userConfig.colors[5].color, 'display' : 'table-cell'}">
								<div class="frame" ng-style="{'background-color':userConfig.colors[6].color}"><p>{{::entity.type}} P#{{::entity.os_index}} ({{::convertMemory(entity.memory)}})</p></div>
								<span ng-repeat="entity in ::entity.children" ng-include="'lstopoTree'">
								</span>
								<span ng-if="entity.pciTree" ng-repeat="tree in ::entity.pciTree" ng-style="{'width': '20%'}">
									<canvas id="{{ ::'tree-' + $index + '-' + tree.os_index }}" ng-controller="TestCtrl" ng-init="begin(tree, $index)" height="500" width="600"></canvas>
								</span>
								</div>
							</div>
						</div>

						<div class="cache3" ng-if="cacheType(entity.type, 'L3Cache')">
							<div ng-show="config.show[0].ticked" class="frame" ng-style="{'background-color':userConfig.colors[0].color}"> <p>{{::renameCache(entity)}} ({{::convertMemory(entity.size)}})</p> </div>
							<span ng-repeat="entity in ::entity.children" ng-include="'lstopoTree'">
							</span>
						</div>

				        <div class="cache2" ng-if="cacheType(entity.type, 'L2Cache')">
				            <div ng-show="config.show[1].ticked" ng-style="{'background-color':userConfig.colors[1].color}" class="frame"> <p>{{::renameCache(entity)}} ({{::convertMemory(entity.size)}})</p> </div>
				            <span ng-repeat="entity in ::entity.children" ng-include="'lstopoTree'">
				            </span>
				        </div>

				        <div class="cache2bis" ng-if="cacheType(entity.type, 'L2iCache')">
				            <div ng-show="config.show[1].ticked" ng-style="{'background-color':userConfig.colors[1].color}" class="frame"> <p>{{::renameCache(entity)}} ({{::convertMemory(entity.size)}})</p> </div>
				            <span ng-repeat="entity in ::entity.children" ng-include="'lstopoTree'">
				            </span>
				        </div>

				        <div class="cache1" ng-if="cacheType(entity.type, 'L1Cache')">
				            <div ng-show="config.show[2].ticked" ng-style="{'background-color':userConfig.colors[2].color}" class="frame"> <p>{{::renameCache(entity)}} ({{::convertMemory(entity.size)}})</p> </div>
				            <span ng-repeat="entity in ::entity.children" ng-include="'lstopoTree'">
				            </span>
				        </div>

				        <div class="cache1bis" ng-if="cacheType(entity.type, 'L1iCache')">
				            <div ng-show="config.show[2].ticked" ng-style="{'background-color':userConfig.colors[2].color}" class="frame"> <p>{{::renameCache(entity)}} ({{::convertMemory(entity.size)}})</p> </div>
				            <span ng-repeat="entity in ::entity.children" ng-include="'lstopoTree'">
				            </span>
				        </div>

						<div class="core frame_pu" ng-if="entity.type=='Core'" ng-init="resizeCaches()">
							<div ng-style="{'background-color':userConfig.colors[3].color}" ><p ng-show="config.show[3].ticked">{{::entity.type}} P#{{::entity.os_index}}</p>
								<div  ng-show="alignementComponents('Pu')" ng-repeat="entity in entity.children" ng-include="'lstopoTree'">
								</div>

			                    <table ng-hide="alignementComponents('Pu')">
			                        <tr>
			                        	<td ng-repeat="entity in ::entity.children" ng-include="'lstopoTree'">
			                        	</td>
			                        </tr>
			                    </table>

							</div>
						</div>

						<div ng-show="config.show[4].ticked" ng-style="{'background-color':userConfig.colors[4].color}" class="frame_pu" ng-if="entity.type=='PU'">
							<p>{{::entity.type}} P#{{::entity.os_index}}</p>
						</div>

          			</script>
      			</div>
    		</div>
  		</div>
	</div>
</div>
